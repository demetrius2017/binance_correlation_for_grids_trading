# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∑–∞–≤—ã—à–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–∏–º—É–ª—è—Ü–∏–∏ Grid Trading

## –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ Grid Trading —Å–∏–º—É–ª—è—Ü–∏–∏ –±—ã–ª–∏ –ø–æ–ª—É—á–µ–Ω—ã –Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ –≤—ã—Å–æ–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- **–û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: 1099.31%** –∑–∞ 90 –¥–Ω–µ–π
- **6327 —Å–¥–µ–ª–æ–∫** –ø—Ä–∏ —à–∞–≥–µ —Å–µ—Ç–∫–∏ 0.30%
- –°—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å –Ω–∞ —Å–¥–µ–ª–∫—É: 0.174% (–ø—Ä–µ–≤—ã—à–∞–µ—Ç —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –º–∞–∫—Å–∏–º—É–º)

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º –≤ –ª–æ–≥–∏–∫–µ

### 1. üö® **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö —É–±—ã—Ç–∫–æ–≤ –æ—Ç —Å—Ç–æ–ø-–ª–æ—Å—Å–æ–≤**
**–î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```python
# –ü—Ä–∏ —Å—Ç–æ–ø-–ª–æ—Å—Å–µ —É—á–∏—Ç—ã–≤–∞–ª–∞—Å—å —Ç–æ–ª—å–∫–æ –∫–æ–º–∏—Å—Å–∏—è
long_body_loss = body_trades * taker_commission  # –¢–æ–ª—å–∫–æ 0.05%

# –ù–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —É–±—ã—Ç–∫–æ–≤
coverage_amount = body_pct * stop_loss_coverage
total_long_pnl += coverage_amount  # –î–æ–±–∞–≤–ª—è–ª–∏ –ø—Ä–∏–±—ã–ª—å!
total_short_pnl -= coverage_amount
```

**–ü–û–°–õ–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```python
# –†–µ–∞–ª—å–Ω—ã–π —É–±—ã—Ç–æ–∫ —Ä–∞–≤–µ–Ω —Ä–∞–∑–º–µ—Ä—É –¥–≤–∏–∂–µ–Ω–∏—è
actual_loss = body_pct  # –ü—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –Ω–∞ 7% —É–±—ã—Ç–æ–∫ = 7%
total_long_pnl -= actual_loss

# –£–±—Ä–∞–Ω–æ –Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —É–±—ã—Ç–∫–æ–≤
# –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ —Å–µ—Ç–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
```

### 2. üö® **–ó–∞–≤—ã—à–µ–Ω–Ω–∞—è –ø—Ä–∏–±—ã–ª—å –æ—Ç maker-–æ—Ä–¥–µ—Ä–æ–≤**
**–î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```python
# 100% –¥–≤–∏–∂–µ–Ω–∏–π –≤ —Ç–µ–Ω—è—Ö –ø—Ä–∏–≤–æ–¥–∏–ª–∏ –∫ —Å–¥–µ–ª–∫–∞–º
long_wick_profit = (upper_wick_trades + lower_wick_trades) * (grid_step - commission)
```

**–ü–û–°–õ–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```python
# –î–æ–±–∞–≤–ª–µ–Ω –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–µ–∞–ª–∏–∑–º–∞
wick_efficiency = 0.75  # 75% —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
effective_wick_trades = (upper_wick_trades + lower_wick_trades) * wick_efficiency
long_wick_profit = effective_wick_trades * (grid_step - commission)
```

### 3. üö® **–ù–µ–¥–æ–æ—Ü–µ–Ω–∫–∞ —É–±—ã—Ç–∫–æ–≤ –æ—Ç –º–æ–ª–Ω–∏–π**
**–î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```python
# –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —É–±—ã—Ç–æ–∫ 2% –ø—Ä–∏ –ª—é–±–æ–º —Ä–∞–∑–º–µ—Ä–µ –º–æ–ª–Ω–∏–∏
if daily_range_pct > 15.0:
    total_long_pnl -= 2.0
    total_short_pnl -= 2.0
```

**–ü–û–°–õ–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```python
# –£–±—ã—Ç–æ–∫ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª–µ–Ω —Ä–∞–∑–º–µ—Ä—É –¥–≤–∏–∂–µ–Ω–∏—è
lightning_loss_pct = min(daily_range_pct * 0.3, 10.0)  # 30% –æ—Ç –¥–≤–∏–∂–µ–Ω–∏—è
total_long_pnl -= lightning_loss_pct
total_short_pnl -= lightning_loss_pct
```

## –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –í —Ñ–∞–π–ª–µ `modules/grid_analyzer.py`:

1. **–°—Ç—Ä–æ–∫–∏ 315-330**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Å—Ç–æ–ø-–ª–æ—Å—Å–æ–≤ –¥–ª—è Long —Å–µ—Ç–∫–∏
   - –î–æ–±–∞–≤–ª–µ–Ω —Ä–µ–∞–ª—å–Ω—ã–π —É–±—ã—Ç–æ–∫: `total_long_pnl -= actual_loss`
   - –£–±—Ä–∞–Ω–æ –Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —É–±—ã—Ç–∫–æ–≤

2. **–°—Ç—Ä–æ–∫–∏ 350-365**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Å—Ç–æ–ø-–ª–æ—Å—Å–æ–≤ –¥–ª—è Short —Å–µ—Ç–∫–∏
   - –î–æ–±–∞–≤–ª–µ–Ω —Ä–µ–∞–ª—å–Ω—ã–π —É–±—ã—Ç–æ–∫: `total_short_pnl -= actual_loss`
   - –£–±—Ä–∞–Ω–æ –Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —É–±—ã—Ç–∫–æ–≤

3. **–°—Ç—Ä–æ–∫–∏ 295-310**: –î–æ–±–∞–≤–ª–µ–Ω –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–µ–∞–ª–∏–∑–º–∞ –¥–ª—è maker-–æ—Ä–¥–µ—Ä–æ–≤
   - `wick_efficiency = 0.75` (75% —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `effective_wick_trades` –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞

4. **–°—Ç—Ä–æ–∫–∏ 270-275**: –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —É–±—ã—Ç–∫–æ–≤ –æ—Ç –º–æ–ª–Ω–∏–π
   - `lightning_loss_pct = min(daily_range_pct * 0.3, 10.0)`
   - –£–±—ã—Ç–æ–∫ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª–µ–Ω —Ä–∞–∑–º–µ—Ä—É –¥–≤–∏–∂–µ–Ω–∏—è

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:
- **–û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å:** 10-50% –∑–∞ 90 –¥–Ω–µ–π (–≤–º–µ—Å—Ç–æ 1099%)
- **–°—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å –Ω–∞ —Å–¥–µ–ª–∫—É:** ‚â§ 0.28% (—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –º–∞–∫—Å–∏–º—É–º)
- **–£—á–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö —É–±—ã—Ç–∫–æ–≤:** –°—Ç–æ–ø-–ª–æ—Å—Å—ã –∏ –º–æ–ª–Ω–∏–∏ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —Å–Ω–∏–∂–∞—é—Ç –ø—Ä–∏–±—ã–ª—å
- **–ë–æ–ª–µ–µ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã:** –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–µ–∞–ª—å–Ω—ã–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º Grid Trading

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥—Ä–∞–≤–æ–≥–æ —Å–º—ã—Å–ª–∞:
- –°—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å –Ω–∞ —Å–¥–µ–ª–∫—É –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç `grid_step - maker_commission`
- –°—Ç–æ–ø-–ª–æ—Å—Å—ã –≤—ã—á–∏—Ç–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —É–±—ã—Ç–∫–∏, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –∫–æ–º–∏—Å—Å–∏–∏
- –ú–æ–ª–Ω–∏–∏ –Ω–∞–Ω–æ—Å—è—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —É—â–µ—Ä–±
- –ù–µ—Ç –º–∞–≥–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è —É–±—ã—Ç–∫–æ–≤ –º–µ–∂–¥—É —Å–µ—Ç–∫–∞–º–∏

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç `test_fixed_simulation.py` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
1. –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
2. –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —É—á–µ—Ç–∞ —Å—Ç–æ–ø-–ª–æ—Å—Å–æ–≤
3. –í–ª–∏—è–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Ä–µ–∞–ª–∏–∑–º–∞
4. –°—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –∑–∞–≤—ã—à–µ–Ω–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- `modules/grid_analyzer.py` - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
- `test_fixed_simulation.py` - —Ç–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- `analyze_simulation_problems.py` - –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º

## –î–∞—Ç–∞
20 –∏—é–Ω—è 2025 –≥.

## –°—Ç–∞—Ç—É—Å
‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –õ–æ–≥–∏–∫–∞ —Å–∏–º—É–ª—è—Ü–∏–∏ –ø—Ä–∏–≤–µ–¥–µ–Ω–∞ –∫ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º —Ä–∞—Å—á–µ—Ç–∞–º, –∑–∞–≤—ã—à–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã.

---

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –î–ª—è –ø–æ–ª–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ Streamlit —Å —Ç–µ–º–∏ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, —á—Ç–æ –¥–∞–≤–∞–ª–∏ –∑–∞–≤—ã—à–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (—à–∞–≥ 0.30%, 90 –¥–Ω–µ–π, ICXUSDT). –ù–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 10-50% –≤–º–µ—Å—Ç–æ 1099%.
